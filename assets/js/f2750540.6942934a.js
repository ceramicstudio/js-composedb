(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[620],{97073:(e,t,n)=>{"use strict";n.r(t),n.d(t,{contentTitle:()=>ft,default:()=>bt,frontMatter:()=>mt,metadata:()=>ht,toc:()=>yt});var r=n(3262),i=n(49231),o=n(54852),a=n(42478),s=n(40996),c=n(39242);async function l(e,t){const n=function(e){const{after:t,before:n,first:r,last:i,...o}=e;let a;if(null!=r?(a={first:r},null!=t&&(a.after=t)):null!=i&&(a={last:i},null!=n&&(a.before=n)),null==a)throw new Error('Missing "first" or "last" connection argument');return{...o,...a}}(t),r=await e.index.query(n);return function(e,t){return{edges:(t.edges??[]).map((t=>{let{cursor:n,node:r}=t;return{cursor:n,node:r?e.buildStreamFromState(r):null}})),pageInfo:{...t.pageInfo,startCursor:t.pageInfo.startCursor??null,endCursor:t.pageInfo.endCursor??null}}}(e,r)}const d=["greaterThan","greaterThanOrEqualTo"],u=["lessThan","lessThanOrEqualTo"];function p(e){if(null==e)throw new Error("No value filter provided");const t=Object.keys(e);if(0===t.length)throw new Error("Invalid empty value filter");if(t.length>2)throw new Error("Too many conditions provided in value filter");if(2===t.length){if(n=t[0],r=t[1],d.includes(n)&&u.includes(r)||d.includes(r)&&u.includes(n))return;throw new Error("Invalid range conditions in value filter")}var n,r;const i=t[0],o=e[i];switch(i){case"in":case"notIn":if(!Array.isArray(o))throw new Error(`Invalid value for condition "${i}": must be an array`);return;case"isNull":case"equalTo":case"notEqualTo":return;default:if(d.includes(i)||u.includes(i))return;throw new Error(`Unexpected condition "${i}" in value filter`)}}function m(e){if(null==e)throw new Error("No query filters provided");const t=Object.keys(e);if(1!==t.length)throw new Error("Invalid query filters: a single key must be provided");const n=t[0],r=e[n];if(null==r)throw new Error("Invalid query filters: missing filter value");switch(n){case"where":return void function(e){if(null==e)throw new Error("No object filter provided");const t=Object.values(e);if(0===t.length)throw new Error("Empty object filter");t.forEach(p)}(r);case"not":return void m(r);case"and":case"or":if(!Array.isArray(r))throw new Error(`Invalid value for "${n}" filter: must be an array`);return void r.forEach(m);default:throw new Error(`Invalid query filter type: expecting "where", "and", "or" or "not" key but got "${n}"`)}}function f(e,t,n){const r={where:{[e]:{equalTo:t}}};return null==n?r:(m(n),{and:[r,n]})}var h=n(75143),y=n(98590),w=n(75331),g=n(12925);function b(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function v(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,b(e,t,"get"))}function k(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function T(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,b(e,t,"set"),n),n}function q(e){return"string"==typeof e?y.i.from(e).toString():e.toString()}const I=()=>Promise.resolve([]);var C=new WeakMap,x=new WeakMap;class E extends g{cache(e){if(!v(this,x))return!1;const t=e.id.toString();return this.clear(t).prime(t,e),!0}async create(e,t,n){let{controller:r,...i}=void 0===n?{}:n;const o={controller:r,model:e instanceof w.Eb?e:w.Eb.fromString(e)},a=await h.U.create(v(this,C),t,o,i);return this.cache(a),a}async load(e){return await super.load(e)}async single(e,t,n){const r={controller:e,model:t instanceof w.Eb?t:w.Eb.fromString(t)},i=await h.U.single(v(this,C),r,n);return this.cache(i),i}async update(e,t,n){let{replace:r,version:i,...o}=void 0===n?{}:n;const a=q(e);this.clear(a);const s=await this.load(a);if(null!=i&&s.commitId.toString()!==i)throw new Error("Stream version mismatch");const c=r?t:{...s.content,...t};return await s.replace(c,o),s}constructor(e){super(I,{cache:!0,cacheKeyFn:q,cacheMap:null!=e.cache&&"boolean"!=typeof e.cache?e.cache:void 0}),k(this,C,{writable:!0,value:void 0}),k(this,x,{writable:!0,value:void 0}),this._batchLoadFn=async t=>{e.cache||this.clearAll();const n=await e.ceramic.multiQuery(t.map(q).map((e=>({streamId:e}))),e.multiqueryTimeout);return t.map((e=>{const t=q(e),r=n[t];return r||new Error(`Failed to load document: ${t}`)}))},T(this,C,e.ceramic),T(this,x,!!e.cache)}}function S(e){const{cache:t,ceramic:n,fallbackViewerID:r}=e,i=e.loader??new E({ceramic:n,cache:t});function o(){const e=n.did;return e?e.hasParent?e.parent:e.id:r??null}return{ceramic:n,loader:i,getViewerID:o,isAuthenticated:()=>n.did?.authenticated??!1,loadDoc:async function(e,t){return void 0===t&&(t=!1),t&&i.clear(e),await i.load(e)},createDoc:async(e,t)=>await i.create(e,t),createSingle:async(e,t)=>{const n=o();if(null==n)throw new Error("Document can only be created with an authenticated account");const r=await i.single(n,e);return await r.replace(t),r},updateDoc:async(e,t,n)=>await i.update(e,t,n),queryConnection:async e=>await l(n,e),queryCount:async e=>await n.index.count(e),querySingle:async e=>await async function(e,t){const n={...t,last:1},r=await e.index.query(n),i=r.edges?.[0]?.node;return i?e.buildStreamFromState(i):null}(n,e)}}var j=n(40078),D=n(47257),$=n(18976),F=n(60945),O=n(74026),_=n(30404),M=n(94516);function P(e){return F.NQ.fromString(e).toString()}function R(e){return w.Eb.fromString(e).toString()}const z=new O.n2({name:"CeramicCommitID",description:"A Ceramic Commit ID",specifiedByURL:"https://github.com/ceramicnetwork/CIP/blob/main/CIPs/CIP-59/CIP-59.md#commitid",serialize:P,parseValue:P,parseLiteral(e){if(e.kind!==_.h.STRING)throw new M.__(`Can only validate strings as CommitID but got a: ${e.kind}`);return P(e.value)}}),N=new O.n2({name:"CeramicStreamID",description:"A Ceramic Stream ID",specifiedByURL:"https://github.com/ceramicnetwork/CIP/blob/main/CIPs/CIP-59/CIP-59.md#streamid",serialize:R,parseValue:R,parseLiteral(e){if(e.kind!==_.h.STRING)throw new M.__(`Can only validate strings as StreamID but got a: ${e.kind}`);return R(e.value)}});var A=n(96784),V=n(98784),U=n(91783),L=n(87140),B=n(11768),Z=n(62619),G=n(3467),W=n(92818),Q=n(17075),K=n(77012),X=n(63831),J=n(5204);function Y(e){return new J.hX(e).toString()}function H(e){return new J.a_(e).toString()}const ee=new O.n2({name:"ChainAgnosticAccountID",description:"A Chain Agnostic AccountId",specifiedByURL:"https://github.com/ChainAgnostic/CAIPs/blob/master/CAIPs/caip-10.md",serialize:Y,parseValue:Y,parseLiteral(e){if(e.kind!==_.h.STRING)throw new M.__(`Can only validate strings as ChainAgnosticAccountID but got a: ${e.kind}`);return Y(e.value)}}),te=new O.n2({name:"ChainAgnosticChainID",description:"A Chain Agnostic ChainId",specifiedByURL:"https://github.com/ChainAgnostic/CAIPs/blob/master/CAIPs/caip-2.md",serialize:H,parseValue:H,parseLiteral(e){if(e.kind!==_.h.STRING)throw new M.__(`Can only validate strings as ChainAgnosticAccountID but got a: ${e.kind}`);return H(e.value)}});function ne(e){e=e?.toUpperCase();return/^([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])(\.\d{1,})?(([Z])|([+|-]([01][0-9]|2[0-3]):[0-5][0-9]))$/.test(e)}function re(e){if(!/^(\d{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01]))$/.test(e))return!1;const t=Number(e.substring(0,4)),n=Number(e.substring(5,2)),r=Number(e.substring(8,2));switch(n){case 2:return!((t%4==0&&t%100!=0||t%400==0)&&r>29)&&!((t%4==0&&t%100!=0||t%400==0)&&r>28);case 4:case 6:case 9:case 11:if(r>30)return!1}return!0}function ie(e){e=e?.toUpperCase();if(!/^(\d{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60))(\.\d{1,})?(([Z])|([+|-]([01][0-9]|2[0-3]):[0-5][0-9]))$/.test(e))return!1;const t=Date.parse(e);if(Number.isNaN(t))return!1;const n=e.indexOf("T"),r=e.substring(0,n),i=e.substring(n+1);return re(r)&&ne(i)}const oe=new O.n2({name:"Date",description:"A date string, such as 2007-12-03, compliant with the `full-date` format outlined in section 5.6 of the RFC 3339 profile of the ISO 8601 standard for representation of dates and times using the Gregorian calendar.",serialize:e=>{if("string"==typeof e&&re(e))return e;throw new TypeError(`Date cannot represent an invalid date-string ${String(e)}.`)},parseValue:e=>{if("string"==typeof e&&re(e))return e;throw new TypeError(`Date cannot represent an invalid date-string ${String(e)}.`)},parseLiteral:e=>{if(e.kind!==_.h.STRING)throw new TypeError("Date cannot represent non string or Date type");const{value:t}=e;if(re(t))return t;throw new TypeError(`Date cannot represent an invalid date-string ${String(t)}.`)},extensions:{codegenScalarType:"string",jsonSchema:{type:"string",format:"date"}}}),ae=new O.n2({name:"DateTime",description:"A date-time string at UTC, such as 2007-12-03T10:15:30Z, compliant with the `date-time` format outlined in section 5.6 of the RFC 3339 profile of the ISO 8601 standard for representation of dates and times using the Gregorian calendar.",serialize:e=>{if("string"==typeof e&&ie(e)){if(-1!==e.indexOf("Z"))return e;throw new TypeError(`DateTime string must be formatted to UTC time ${String(e)}.`)}throw new TypeError(`DateTime cannot represent an invalid date-time-string ${String(e)}.`)},parseValue:e=>{if("string"==typeof e&&ie(e))return e;throw new TypeError(`DateTime cannot represent an invalid date-time-string ${String(e)}.`)},parseLiteral:e=>{if(e.kind!==_.h.STRING)throw new TypeError("DateTime cannot represent non string or Date type");const{value:t}=e;if(ie(t))return t;throw new TypeError(`DateTime cannot represent an invalid date-time-string ${String(t)}.`)},extensions:{codegenScalarType:"string",jsonSchema:{type:"string",format:"date-time"}}}),se=new O.n2({name:"Time",description:"A time string at UTC, such as 10:15:30Z, compliant with the `full-time` format outlined in section 5.6 of the RFC 3339profile of the ISO 8601 standard for representation of dates and times using the Gregorian calendar.",serialize(e){if(e instanceof Date){const t=e.toISOString();return t.substring(t.indexOf("T")+1)}if("string"==typeof e){if(ne(e))return e;throw new TypeError(`Time cannot represent an invalid time-string ${e}.`)}throw new TypeError("Time cannot be serialized from a non string, or non Date type "+JSON.stringify(e))},parseValue(e){if("string"!=typeof e)throw new TypeError(`Time cannot represent non string type ${JSON.stringify(e)}`);if(ne(e))return e;throw new TypeError(`Time cannot represent an invalid time-string ${e}.`)},parseLiteral(e){if(e.kind!==_.h.STRING)throw new TypeError(`Time cannot represent non string type: ${e.kind}`);const t=e.value;if(ne(t))return t;throw new TypeError(`Time cannot represent an invalid time-string ${String(t)}.`)},extensions:{codegenScalarType:"string",jsonSchema:{type:"string",format:"time"}}});var ce=n(72243);function le(e){const t="string"==typeof e?ce.k0.parse(e):ce.k0.asCID(e);if(null==t)throw new M.__(`Could not parse input as CID: ${e}`);return t.toV1().toString()}const de=new O.n2({name:"InterPlanetaryCID",description:"A IPLD CID",specifiedByURL:"https://github.com/multiformats/cid",serialize:le,parseValue:le,parseLiteral(e){if(e.kind!==_.h.STRING)throw new M.__(`Can only validate strings as CID but got a: ${e.kind}`);return le(e.value)}}),ue=new O.n2({name:"URI",description:"A field whose value conforms to the standard Uniform Resource Identifier (URI) format as specified in RFC3986.",specifiedByURL:"https://www.ietf.org/rfc/rfc3986.txt",parseValue:e=>e,parseLiteral(e){if(e.kind!==_.h.STRING)throw new M.__(`Can only validate strings as URIs but got a: ${e.kind}`);return e.value},extensions:{jsonSchema:{type:"string",format:"uri"}}}),pe={accountid:ee,boolean:A.EZ,chainid:te,cid:de,commitid:z,countrycode:V.h,date:oe,datetime:ae,did:U.d,duration:L.sW,float:A.av,id:A.km,integer:A._o,latitude:B.o,localdate:Z.$,locale:G.c,localtime:W.Nc,longitude:Q.v,streamid:N,string:A.kH,time:se,timezone:K.M,uri:ue,utcoffset:X.X},me=Object.keys(pe);function fe(e){if(function(e){return me.includes(e)}(e))return pe[e];throw new Error(`Unsupported scalar type: ${e}`)}var he=n(46752),ye=n(9438),we=n(40461);function ge(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function be(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,ge(e,t,"get"))}function ve(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function ke(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,ge(e,t,"set"),n),n}const Te=["meta","reference","list","view"];function qe(e){return!Te.includes(e.type)}const Ie=["enum","node"];function Ce(e){return"reference"===e.type&&Ie.includes(e.refType)}const xe={...we.Zd,account:{type:A.km,description:"Returns only documents created by the provided account"}},Ee=new O.sR({name:"UpdateOptionsInput",fields:{replace:{type:A.EZ,defaultValue:!1,description:"Fully replace the document contents instead of performing a shallow merge"},version:{type:z,description:"Only perform mutation if the document matches the provided version"}}}),Se=new O.mR({name:"SortOrder",values:{ASC:{value:"ASC"},DESC:{value:"DESC"}}});function je(e){return new O.sR({name:`${e.name}ValueFilterInput`,fields:{isNull:{type:A.EZ},equalTo:{type:e},notEqualTo:{type:e},in:{type:new O.p2(new O.bM(e))},notIn:{type:new O.p2(new O.bM(e))}}})}function De(e){return new O.sR({name:`${e.name}ValueFilterInput`,fields:{isNull:{type:A.EZ},equalTo:{type:e},notEqualTo:{type:e},in:{type:new O.p2(new O.bM(e))},notIn:{type:new O.p2(new O.bM(e))},lessThan:{type:e},lessThanOrEqualTo:{type:e},greaterThan:{type:e},greaterThanOrEqualTo:{type:e}}})}const $e={BooleanValueFilter:new O.sR({name:"BooleanValueFilterInput",fields:{isNull:{type:A.EZ},equalTo:{type:A.EZ}}}),FloatValueFilter:De(A.av),IntValueFilter:De(A._o),StringValueFilter:De(A.kH)},Fe={boolean:"BooleanValueFilter",float:"FloatValueFilter",integer:"IntValueFilter",string:"StringValueFilter"};var Oe=new WeakMap,_e=new WeakMap,Me=new WeakMap,Pe=new WeakMap,Re=new WeakMap,ze=new WeakMap;class Ne{build(){this._buildEnums();const e=this._createSharedDefinitions();this._buildObjects(e),this._buildConnections();const t=this._createSchema(e);return(0,he.J)(t),t}_createSharedDefinitions(){const e=(0,we.SX)((async(e,t)=>e.startsWith("did:")?e:await t.loadDoc(e)),(e=>"string"==typeof e?"CeramicAccount":be(this,ze)[e.metadata.model?.toString()])),t=new O.h6({name:"CeramicAccount",interfaces:[e.nodeInterface],fields:()=>{const e={id:{type:new O.bM(A.km),description:"Globally unique identifier of the account (DID string)",resolve:e=>e},isViewer:{type:new O.bM(A.EZ),description:"Whether the Ceramic instance is currently authenticated with this account or not",resolve:(e,t,n)=>n.isAuthenticated()&&n.getViewerID()===e}};for(const[t,n]of Object.entries(be(this,Oe).accountData??{})){const r=be(this,Oe).models[n.name];if(null==r)throw new Error(`Missing model for reference name: ${n.name}`);if("node"===n.type)e[t]={type:be(this,Me)[n.name],resolve:async(e,t,n)=>await n.querySingle({account:e,model:r.id})};else{if("connection"!==n.type)throw new Error(`Unsupported reference type: ${n.type}`);{const i=be(this,Pe)[`${n.name}Filters`],o=be(this,Pe)[`${n.name}Sorting`],a={...we.Zd};i&&o&&(a.filters={type:i},a.sorting={type:o}),e[t]={type:be(this,Me)[`${n.name}Connection`],args:a,resolve:async(e,t,n)=>{let{filters:i,...o}=t;return null!=i&&m(i),await n.queryConnection({...o,queryFilters:i,account:e,model:r.id})}},e[`${t}Count`]={type:new O.bM(A._o),args:i?{filters:{type:i}}:{},resolve:async(e,t,n)=>{let{filters:i}=t;return null!=i&&m(i),await n.queryCount({queryFilters:i,account:e,model:r.id})}}}}}return e}}),n={node:e.nodeField,viewer:{type:t,description:"Account currently authenticated on the Ceramic instance, if set",resolve:(e,t,n)=>n.getViewerID()}};return{...e,accountObject:t,queryFields:n}}_buildEnums(){for(const[e,t]of Object.entries(be(this,Oe).enums))be(this,Me)[e]=new O.mR({name:e,values:t.reduce(((e,t)=>(e[t]={value:t},e)),{})})}_buildObjects(e){for(const[t,n]of Object.entries(be(this,Oe).objects))this._buildObjectType({definitions:e,name:t,fields:n})}_buildObjectType(e){const t=be(this,Oe).models[e.name];return t?this._buildDocumentObjectType({model:t,...e}):this._buildEmbeddedObjectType(e)}_buildDocumentObjectType(e){let{model:t,definitions:n,name:r,fields:i}=e;be(this,Me)[r]=new O.h6({name:r,interfaces:[n.nodeInterface],isTypeOf:e=>e.metadata.model.toString()===t.id,fields:()=>{const e={id:{type:new O.bM(A.km),resolve:e=>e.id.toString()}};for(const[t,r]of Object.entries(i))switch(r.type){case"meta":continue;case"reference":e[t]=this._buildDocumentObjectReferenceField(t,r);break;case"list":e[t]={type:this._buildObjectListFieldType(n,r),resolve:e=>e.content?.[t]};break;case"view":{const o=this._buildDocumentObjectViewField(t,n,r,i);o&&(e[t]=o);break}default:e[t]={type:this._buildScalarFieldType(n,r),resolve:e=>e.content?.[t]}}return e}}),this._buildFiltersType(r,i),this._buildSortingType(r,i),be(this,_e)||(this._buildInputObjectType(r,i),this._buildNodeMutations(n.queryFields,r,t))}_buildEmbeddedObjectType(e){let{definitions:t,name:n,fields:r}=e;be(this,Me)[n]=new O.h6({name:n,fields:()=>{const e={};for(const[i,o]of Object.entries(r))switch(o.type){case"meta":continue;case"reference":e[i]=this._buildEmbeddedObjectReferenceField(i,o);break;case"list":e[i]={type:this._buildObjectListFieldType(t,o),resolve:e=>e[i]};break;case"view":throw new Error(`Unsupported view field ${i} on embedded object ${n}`);default:e[i]={type:this._buildScalarFieldType(t,o),resolve:e=>e[i]}}return e}}),be(this,_e)||this._buildInputObjectType(n,r)}_buildConnections(){for(const e of Object.keys(be(this,Oe).models)){const t=be(this,Me)[e];if(null==t)throw new Error(`Missing object type for connection: ${e}`);const{connectionType:n,edgeType:r}=(0,we.Tr)({nodeType:t});be(this,Me)[`${e}Connection`]=n,be(this,Me)[`${e}Edge`]=r}}_buildDocumentObjectReferenceField(e,t){const n="connection"===t.refType?t.refName+"Connection":t.refName,r=be(this,Me)[n];if(null==r)throw new Error(`Missing type: ${n}`);const i=t.required?new O.bM(r):r;switch(t.refType){case"connection":return{type:i,args:we.Zd,resolve:(e,t,n)=>{throw new Error("Not implemented")}};case"node":return{type:i,args:we.Zd,resolve:async(t,n,r)=>await r.loadDoc(t.content[e])};case"enum":case"object":return{type:i,resolve:t=>t.content[e]};default:throw new Error(`Unsupported reference type on document object: ${t.refType}`)}}_buildEmbeddedObjectReferenceField(e,t){const n=be(this,Me)[t.refName];if(null==n)throw new Error(`Missing type: ${t.refName}`);const r=t.required?new O.bM(n):n;switch(t.refType){case"enum":case"object":return{type:r,resolve:t=>t[e]};default:throw new Error(`Unsupported reference type on embedded object: ${t.refType}`)}}_buildObjectListFieldType(e,t){let n;if("reference"===t.item.type){if(n=be(this,Me)[t.item.refName],null==n)throw new Error(`Missing referenced object type: ${t.item.refName}`)}else n="did"===t.item.type?e.accountObject:fe(t.item.type);t.item.required&&(n=new O.bM(n));const r=new O.p2(n);return t.required?new O.bM(r):r}_buildDocumentObjectRelation(e,t,n){const r=be(this,ze)[t.model];if(null==r)throw new Error(`Model alias not found for relation with ID ${t.model} on field ${e}`);switch(t.source){case"document":if(null==n[t.property])throw new Error(`Missing reference field ${t.property} for relation defined on field ${e}`);return{type:be(this,Me)[r],resolve:async(e,n,r)=>{const i=e.content?.[t.property];if(null==i)return null;const o=await r.loadDoc(i);if(null==o)return null;const a=o.metadata.model.toString();return null!=t.model&&a!==t.model?(console.warn(`Ignoring unexpected model ${a} for document ${i}, expected model ${t.model}`),null):o}};case"queryConnection":{const e=be(this,Pe)[`${r}Filters`],n=be(this,Pe)[`${r}Sorting`],i={...xe};return e&&n&&(i.filters={type:e},i.sorting={type:n}),{type:new O.bM(be(this,Me)[`${r}Connection`]),args:i,resolve:async(e,n,r)=>{const i="documentAccount"===n.account?e.metadata.controller:n.account,o=f(t.property,e.id.toString(),n.filters);return await r.queryConnection({...n,account:i,model:t.model,queryFilters:o})}}}case"queryCount":{const e=be(this,Pe)[`${r}Filters`],n={account:{type:A.km,description:"Counts only documents created by the provided account"}};return e&&(n.filters={type:e}),{type:new O.bM(A._o),args:n,resolve:async(e,n,r)=>{const i="documentAccount"===n.account?e.metadata.controller:n.account,o=f(t.property,e.id.toString(),n.filters);return await r.queryCount({account:i,model:t.model,queryFilters:o})}}}default:throw new Error(`Unsupported relation source: ${t.source}`)}}_buildDocumentObjectViewField(e,t,n,r){switch(n.viewType){case"documentAccount":return{type:new O.bM(t.accountObject),description:"Account controlling the document",resolve:e=>e.metadata.controller};case"documentVersion":return{type:new O.bM(z),description:"Current version of the document",resolve:e=>e.commitId.toString()};case"relation":return this._buildDocumentObjectRelation(e,n.relation,r);default:throw new Error(`Unsupported view type: ${n.viewType}`)}}_buildScalarFieldType(e,t){const n="did"===t.type?e.accountObject:fe(t.type);return t.required?new O.bM(n):n}_buildFiltersType(e,t){const n=`${e}ObjectFilter`,r=`${e}Filters`,i={};for(const[o,a]of Object.entries(t)){let e;if("reference"===a.type&&a.indexed)if("enum"===a.refType){e=je(be(this,Me)[a.refName]),be(this,Pe)[e.name]=e}else"node"===a.refType&&(e=be(this,Pe).StringValueFilter);else qe(a)&&a.indexed&&(e=be(this,Pe)[Fe[a.type]??"StringValueFilter"]);null!=e&&(i[o]={type:e})}Object.keys(i).length>0&&(be(this,Pe)[n]=new O.sR({name:`${n}Input`,fields:()=>i}),be(this,Pe)[r]=new O.sR({name:`${r}Input`,fields:()=>({where:{type:be(this,Pe)[n]},and:{type:new O.p2(new O.bM(be(this,Pe)[r]))},or:{type:new O.p2(new O.bM(be(this,Pe)[r]))},not:{type:be(this,Pe)[r]}})}))}_buildSortingType(e,t){const n=`${e}Sorting`,r={};for(const[i,o]of Object.entries(t))(Ce(o)||qe(o))&&o.indexed&&(r[i]={type:Se});Object.keys(r).length>0&&(be(this,Pe)[n]=new O.sR({name:`${n}Input`,fields:()=>r}))}_buildInputObjectType(e,t){const n=null!=be(this,Oe).models[e],r=e=>{const r={},i=n||e?"":"Partial";for(const[n,o]of Object.entries(t)){let t;switch(o.type){case"meta":case"view":continue;case"reference":switch(o.refType){case"connection":continue;case"enum":t=be(this,Me)[o.refName];break;case"node":t=A.km;break;case"object":if(t=be(this,Pe)[i+o.refName],null==t)throw new Error(`Missing referenced input type: ${i+o.refName}`)}break;case"list":{let e;if("reference"===o.item.type){if(e=be(this,Pe)[i+o.item.refName],null==e)throw new Error(`Missing referenced input type: ${i+o.item.refName}`)}else e=fe(o.item.type);t=new O.p2(e);break}default:t=fe(o.type)}null!=t&&(r[n]={type:e&&o.required?new O.bM(t):t})}return r};be(this,Pe)[e]=new O.sR({name:`${e}Input`,fields:()=>r(!0)}),n&&(be(this,Pe)[`Partial${e}`]=new O.sR({name:`Partial${e}Input`,fields:()=>r(!1)}))}_buildNodeMutations(e,t,n){be(this,Re)[`create${t}`]=(0,we.Fj)({name:`Create${t}`,inputFields:()=>({content:{type:new O.bM(be(this,Pe)[t])}}),outputFields:()=>({...e,document:{type:new O.bM(be(this,Me)[t])}}),mutateAndGetPayload:async(e,t)=>{if(null==t.ceramic.did||!t.ceramic.did.authenticated)throw new Error("Ceramic instance is not authenticated");return{document:"single"===n.accountRelation.type?await t.createSingle(n.id,e.content):await t.createDoc(n.id,e.content)}}}),be(this,Re)[`update${t}`]=(0,we.Fj)({name:`Update${t}`,inputFields:()=>({id:{type:new O.bM(A.km)},content:{type:new O.bM(be(this,Pe)[`Partial${t}`])},options:{type:Ee}}),outputFields:()=>({...e,document:{type:new O.bM(be(this,Me)[t])}}),mutateAndGetPayload:async(e,t)=>{if(null==t.ceramic.did||!t.ceramic.did.authenticated)throw new Error("Ceramic instance is not authenticated");return{document:await t.updateDoc(e.id,e.content,e.options)}}})}_createSchema(e){const t={nodes:e.nodesField,...e.queryFields};for(const[r,i]of Object.entries(be(this,Oe).models)){const e=r[0].toLowerCase(),n=r.slice(1),o=be(this,Pe)[`${r}Filters`],a=be(this,Pe)[`${r}Sorting`],s={...we.Zd};o&&a&&(s.filters={type:o},s.sorting={type:a}),t[`${e}${n}Index`]={type:be(this,Me)[`${r}Connection`],args:s,resolve:async(e,t,n)=>{let{filters:r,...o}=t;return null!=r&&m(r),await n.queryConnection({...o,queryFilters:r,model:i.id})}},t[`${e}${n}Count`]={type:new O.bM(A._o),args:o?{filters:{type:o}}:{},resolve:async(e,t,n)=>{let{filters:r}=t;return null!=r&&m(r),await n.queryCount({queryFilters:r,model:i.id})}}}const n={query:new O.h6({name:"Query",fields:t})};return be(this,_e)||0===Object.keys(be(this,Re)).length||(n.mutation=new O.h6({name:"Mutation",fields:be(this,Re)})),new ye.XO(n)}constructor(e){ve(this,Oe,{writable:!0,value:void 0}),ve(this,_e,{writable:!0,value:void 0}),ve(this,Me,{writable:!0,value:{SortOrder:Se}}),ve(this,Pe,{writable:!0,value:{...$e}}),ve(this,Re,{writable:!0,value:{}}),ve(this,ze,{writable:!0,value:void 0}),ke(this,Oe,e.definition),ke(this,_e,!!e.readonly),ke(this,ze,Object.entries(be(this,Oe).models).reduce(((e,t)=>{let[n,r]=t;return e[r.id]=n,e}),{}))}}function Ae(e){return new Ne(e).build()}function Ve(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function Ue(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Ve(e,t,"get"))}function Le(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Be(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Ve(e,t,"set"),n),n}var Ze=new WeakMap,Ge=new WeakMap;class We{get context(){return Ue(this,Ze)}async execute(e,t){const n=(0,j.Gu)(Ue(this,Ge),e);return n.length>0?{errors:n}:await(0,D.ht)({document:e,variableValues:t,contextValue:Ue(this,Ze),schema:Ue(this,Ge)})}async executeQuery(e,t){let n;try{n=(0,$.Qc)(e)}catch(r){return{errors:[r]}}return await this.execute(n,t)}constructor(e){Le(this,Ze,{writable:!0,value:void 0}),Le(this,Ge,{writable:!0,value:void 0});const{ceramic:t,context:n,definition:r,readonly:i,schema:o,...a}=e,s="string"==typeof t?new c.v(t):t;Be(this,Ze,n??S({...a,ceramic:s})),Be(this,Ge,function(e){const{definition:t,readonly:n,schema:r}=e;if(null!=r)return r;if(null==t)throw new Error("Invalid parameters to get schema: missing definition or schema");return Ae({definition:t,readonly:n})}({definition:r,readonly:i,schema:o}))}}var Qe=n(74552);const Ke="ComposeDB-ViewerID";var Xe=n(77780),Je=n(88276),Ye=n(66374);function He(e){const{definition:t,getViewerID:n,remoteExecutor:r,serverURL:i}=e;let o;if("function"==typeof r)o=r;else{if("function"!=typeof n||"string"!=typeof i)throw new Error("Invalid parameters to create hybrid schema: missing `remoteExecutor` or `getViewerID` and `serverURL` parameters");o=function(e,t){return(0,Xe.K)((async n=>{let{document:r,variables:i}=n;const o=t(),a=o?{[Ke]:o}:{};return await(0,Qe.r)(e,{method:"POST",headers:a,body:{query:(0,Ye.S)(r),variables:i}})}))}(i,n)}const a={executor:o,schema:Ae({definition:t,readonly:!0})};return(0,Je.g)({subschemas:[Ae({definition:t}),a],mergeTypes:!1,onTypeConflict:(e,t,n)=>n?.left.subschema===a?e:t})}function et(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function tt(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,et(e,t,"get"))}function nt(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function rt(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,et(e,t,"set"),n),n}var it=new WeakMap,ot=new WeakMap,at=new WeakMap;class st{get context(){return tt(this,it)}get did(){return tt(this,it).ceramic.did}get id(){return tt(this,it).getViewerID()}get resources(){return tt(this,ot)}setDID(e){tt(this,it).ceramic.did=e}async execute(e,t){return await tt(this,at).execute(e,t)}async executeQuery(e,t){return await tt(this,at).executeQuery(e,t)}constructor(e){nt(this,it,{writable:!0,value:void 0}),nt(this,ot,{writable:!0,value:void 0}),nt(this,at,{writable:!0,value:void 0});const{ceramic:t,definition:n,remoteExecutor:r,serverURL:i,...o}=e,a="string"==typeof t?new c.v(t):t;rt(this,it,S({...o,ceramic:a})),rt(this,ot,Object.values(n.models).map((e=>`ceramic://*?model=${e.id}`)));const s={ceramic:a,context:tt(this,it),definition:n};null==r&&null==i||(s.schema=He({definition:n,getViewerID:()=>this.id,remoteExecutor:r,serverURL:i})),rt(this,at,new We(s))}}var ct=n(70623);const lt={models:{BasicProfile:{id:"kjzl6hvfrbw6c8i6k87cma2gvbnw3hgz2j2tc0hmc6yzzc1zikbwsryulsnmmak",accountRelation:{type:"single"}},Posts:{id:"kjzl6hvfrbw6cags7lvf5ajsgdfqwnnhoyp5fr3fhmitskk0ksydeaspzxckpub",accountRelation:{type:"list"}},Following:{id:"kjzl6hvfrbw6c930807bvmzvcqkqv6ni1q2jhv5bc59hima9r9ci1zk22tpxq3v",accountRelation:{type:"list"}},Comments:{id:"kjzl6hvfrbw6cb3x190263pxlza37ls1gxizt1ea21gtr9xwp7qln05elotk0h8",accountRelation:{type:"list"}}},objects:{BasicProfile:{name:{type:"string",required:!0},emoji:{type:"string",required:!1},gender:{type:"string",required:!1},username:{type:"string",required:!0},description:{type:"string",required:!1},posts:{type:"view",viewType:"relation",relation:{source:"queryConnection",model:"kjzl6hvfrbw6cags7lvf5ajsgdfqwnnhoyp5fr3fhmitskk0ksydeaspzxckpub",property:"profileId"}},author:{type:"view",viewType:"documentAccount"}},Posts:{tag:{type:"string",required:!0,indexed:!0},body:{type:"string",required:!0},edited:{type:"datetime",required:!1,indexed:!0},created:{type:"datetime",required:!0,indexed:!0},profileId:{type:"streamid",required:!0},profile:{type:"view",viewType:"relation",relation:{source:"document",model:"kjzl6hvfrbw6c8i6k87cma2gvbnw3hgz2j2tc0hmc6yzzc1zikbwsryulsnmmak",property:"profileId"}},responses:{type:"view",viewType:"relation",relation:{source:"queryConnection",model:"kjzl6hvfrbw6cb3x190263pxlza37ls1gxizt1ea21gtr9xwp7qln05elotk0h8",property:"postId"}},author:{type:"view",viewType:"documentAccount"}},Following:{profileId:{type:"streamid",required:!0},profile:{type:"view",viewType:"relation",relation:{source:"document",model:"kjzl6hvfrbw6c8i6k87cma2gvbnw3hgz2j2tc0hmc6yzzc1zikbwsryulsnmmak",property:"profileId"}}},Comments:{edited:{type:"datetime",required:!1,indexed:!0},postId:{type:"streamid",required:!0},comment:{type:"string",required:!0},created:{type:"datetime",required:!0,indexed:!0},profileId:{type:"streamid",required:!0},post:{type:"view",viewType:"relation",relation:{source:"document",model:"kjzl6hvfrbw6cags7lvf5ajsgdfqwnnhoyp5fr3fhmitskk0ksydeaspzxckpub",property:"postId"}},profile:{type:"view",viewType:"relation",relation:{source:"document",model:"kjzl6hvfrbw6c8i6k87cma2gvbnw3hgz2j2tc0hmc6yzzc1zikbwsryulsnmmak",property:"profileId"}}}},enums:{},accountData:{basicProfile:{type:"node",name:"BasicProfile"},postsList:{type:"connection",name:"Posts"},followingList:{type:"connection",name:"Following"},commentsList:{type:"connection",name:"Comments"}}},dt=async e=>{ct.ZP.initialize("G-V2Y8T342EX");const t=new st({ceramic:"https://ceramic-temp.hirenodes.io",definition:lt}),n=await t.executeQuery(`${e.query}`);if(console.log(n),n.errors&&ct.ZP.event({category:"sandbox-query",action:"query-error"}),!n.data.__schema)return ct.ZP.event({category:"sandbox-query",action:"query-success"}),n.data},ut={profiles:{values:[{title:"Profile Index",query:"query ProfileIndex {\n  basicProfileIndex(first: 10) {\n    edges {\n      node {\n        id\n        author{\n          id\n        }\n        username\n        description\n        gender\n        emoji\n      }\n    }\n  }\n}"},{title:"Known Did",query:'query KnownDid {\n  node(id: "did:pkh:eip155:1:0xc362c16a0dcbea78fb03a8f97f56deea905617bb") {\n  ... on CeramicAccount {\n        basicProfile {\n          id\n          name\n          username\n          description\n          gender\n          emoji\n        }\n      }\n  \t}\n\t}'},{title:"Profile with Posts",query:"query WithPosts {\n  basicProfileIndex(first: 10) {\n    edges {\n      node {\n        username\n        posts(first: 5) {\n          edges {\n            node {\n              body\n              created\n            }\n          }\n        }\n      }\n    }\n  }\n}"},{title:"Profile with Comments on Posts",query:"query WithComments {\n  basicProfileIndex(first: 10) {\n    edges {\n      node {\n        username\n        posts(first: 5) {\n          edges {\n            node {\n              body\n              created\n              responses(first: 10) {\n                edges {\n                  node {\n                    comment\n                    created\n                    profile {\n                      username\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}"},{title:"Known Stream",query:'query KnownStream {\n  node(id: "k2t6wzhkhabz3a7xz88mk93y1q2waejk1w2b5rs3kc82e42dgpe4l1h4mcibih") {\n    ... on BasicProfile {\n      id\n      username\n      description\n      gender\n      emoji\n    }\n  }\n}'}]},comments:{values:[{title:"Comments With Posts",query:"query CommentsWithPost {\n    commentsIndex(last: 20) {\n      edges {\n        node {\n          comment\n          post {\n            body\n            profile {\n              username\n            }\n          }\n        }\n      }\n    }\n  }"},{title:"Ordered Comments",query:"query OrderedComments {\n    commentsIndex(sorting: { created: ASC }, first: 10) {\n      edges {\n        node {\n          comment\n          created\n          post {\n            body\n            profile {\n              username\n            }\n          }\n        }\n      }\n    }\n  }"}]},posts:{values:[{title:"Posts Index",query:"query PostsIndex{\n  postsIndex(first: 10) {\n    edges {\n      node {\n        id\n        body\n        tag\n        created\n        profile {\n          username\n        }\n        author{\n          id\n        }\n        responses(first: 1) {\n          edges {\n            node {\n              comment\n              created\n              profile {\n                username\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}"},{title:"Known DID",query:'query KnownDid{\n  node(id: "did:pkh:eip155:11155111:0x8071f6f971b438f7c0ea72c950430ee7655fabce") {\n      ... on CeramicAccount {\n      id\n      postsList(first: 100) {\n        edges {\n        node {\n            id\n            body\n            created\n            profile {\n              username\n            }\n          \tresponses(first: 5){\n              edges{\n                node{\n                  comment\n                }\n              }\n          \t}\n          }\n        }\n      }\n    } \n  }\n}'},{title:"Tag Filtered",query:'query TagFiltered {\n  postsIndex(filters: { where: { tag: { equalTo: "Governance" } } }, first: 10) {\n    edges {\n      node {\n        body\n        created\n        profile {\n          username\n        }\n      }\n    }\n  }\n}'},{title:"Date Filtered",query:'query DateFiltered {\n  postsIndex(filters: { where: { created: { greaterThan: "2022-05-10T14:15:00Z" } } }, first: 10) {\n    edges {\n      node {\n        body\n        created\n        profile {\n          username\n        }\n      }\n    }\n  }\n}'},{title:"Combine Filters",query:'query CombineFilters {\n  postsIndex(\n    filters: {\n      and: [\n        { where: { created: { greaterThan: "2022-05-10T14:15:00Z" } } }\n        { and: { where: { tag: { equalTo: "Governance" } } } }\n      ]\n    }\n    first: 20\n  ) {\n    edges {\n      node {\n        body\n        created\n        tag\n      }\n    }\n  }\n}'}]}};function pt(e){return(0,a.Z)()?i.createElement(s.yB,{defaultTabs:ut[e.queries].values,storage:null,fetcher:dt}):i.createElement("div",null,"loading...")}n(79055),n(15062);const mt={title:"ComposeDB API Sandbox",description:"Test out example GraphQL queries on ComposeDB to learn how to access documents by relations, how to filter, and more.",hide_table_of_contents:!0},ft="Sandbox",ht={type:"mdx",permalink:"/sandbox",source:"@site/src/pages/sandbox.mdx",title:"ComposeDB API Sandbox",description:"Test out example GraphQL queries on ComposeDB to learn how to access documents by relations, how to filter, and more.",frontMatter:{title:"ComposeDB API Sandbox",description:"Test out example GraphQL queries on ComposeDB to learn how to access documents by relations, how to filter, and more.",hide_table_of_contents:!0}},yt=[{value:"Data Models",id:"data-models",level:2},{value:"Instructions",id:"instructions",level:3},{value:"Reading Profiles",id:"reading-profiles",level:2},{value:"<br />",id:"br-",level:2},{value:"Reading Posts",id:"reading-posts",level:2},{value:"<br />",id:"br--1",level:2},{value:"Reading Comments",id:"reading-comments",level:2},{value:"<br />",id:"br--2",level:2},{value:"Next Steps",id:"next-steps",level:2}],wt={toc:yt},gt="wrapper";function bt(e){let{components:t,...n}=e;return(0,o.kt)(gt,(0,r.Z)({},wt,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"sandbox"},"Sandbox"),(0,o.kt)("p",null,"Test out several pre-made example queries below to gain hands-on exposure to accessing documents by relations, filtering and ordering by fields, and combining query logic."),(0,o.kt)("p",null,"For a deeper dive into querying, visit the ",(0,o.kt)("a",{parentName:"p",href:"./docs/0.5.x/guides/data-interactions/queries"},(0,o.kt)("strong",{parentName:"a"},"queries"))," page."),(0,o.kt)("h2",{id:"data-models"},"Data Models"),(0,o.kt)("hr",null),(0,o.kt)("p",null,"The schema definitions that this sandbox uses are outlined in ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/ceramicstudio/EthDenver2023Demo/tree/main/composites"},(0,o.kt)("strong",{parentName:"a"},"this repository")),". The sandbox has been pre-populated with data corresponding to several fictionary people."),(0,o.kt)("h3",{id:"instructions"},"Instructions"),(0,o.kt)("p",null,"To interact with the ComposeDB Sandbox, simply press the pink play icon to execute the pre-written queries in the left-hand side of the embedded GraphiQL IDE. Results returned from your query will populate in the right-hand side of the interface."),(0,o.kt)("p",null,"You can also alter your query logic however you see fit, or build your own queries entirely from scratch based on the schema definitions."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Please note that this sandbox only processes read requests.")),(0,o.kt)("h2",{id:"reading-profiles"},"Reading Profiles"),(0,o.kt)("hr",null),(0,o.kt)("p",null,"Use the example queries below to access data related to the ",(0,o.kt)("inlineCode",{parentName:"p"},"BasicProfile")," model:"),(0,o.kt)("div",{style:{height:"60rem",width:"100%",margin:"auto"}},(0,o.kt)(pt,{queries:"profiles",mdxType:"Sandbox"})),(0,o.kt)("h2",{id:"br-"},(0,o.kt)("br",null)),(0,o.kt)("h2",{id:"reading-posts"},"Reading Posts"),(0,o.kt)("hr",null),(0,o.kt)("p",null,"Use the example queries below to access data related to the ",(0,o.kt)("inlineCode",{parentName:"p"},"Posts")," model:"),(0,o.kt)("div",{style:{height:"60rem",width:"100%",margin:"auto"}},(0,o.kt)(pt,{queries:"posts",mdxType:"Sandbox"})),(0,o.kt)("h2",{id:"br--1"},(0,o.kt)("br",null)),(0,o.kt)("h2",{id:"reading-comments"},"Reading Comments"),(0,o.kt)("hr",null),(0,o.kt)("p",null,"Use the example queries below to access data related to the ",(0,o.kt)("inlineCode",{parentName:"p"},"Comments")," model:"),(0,o.kt)("div",{style:{height:"60rem",width:"100%",margin:"auto"}},(0,o.kt)(pt,{queries:"comments",mdxType:"Sandbox"})),(0,o.kt)("h2",{id:"br--2"},(0,o.kt)("br",null)),(0,o.kt)("h2",{id:"next-steps"},"Next Steps"),(0,o.kt)("hr",null),(0,o.kt)("p",null,"To begin building with ComposeDB in your local environment using the same data models you just queried, get started ",(0,o.kt)("a",{parentName:"p",href:"./docs/0.5.x/set-up-your-environment"},(0,o.kt)("strong",{parentName:"a"},"Setting Up Your Environment")),"."))}bt.isMDXComponent=!0},24079:()=>{}}]);