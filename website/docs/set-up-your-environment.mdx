import Tabs from  '@theme/Tabs'
import TabItem from  '@theme/TabItem'

# Set up your environment
Install and configure relevant packages and tools for ComposeDB.

## Installation

---

### Create your project directory
Start with creating the project directory. Here youâ€™ll store all your appâ€™s local files:
```bash
mkdir my-project #creates a new directory
cd my-project #targets the created directory
```

### Node.js
If you donâ€™t already have them installed, you will need to install Node.js v16 and a package manager. We primarily use `pnpm`, but `npm` and `yarn` are supported as well.
- [NodeJS v16](https://nodejs.org/en/)
- [pnpm v7](https://pnpm.io/installation)

Use this command to make sure you have the correct versions installed.
```bash
node -v
pnpm -v
```

### Ceramic
ComposeDB runs on Ceramic, so you will need to run a Ceramic node. To get started, we recommend running a local Ceramic node. If you're interested in running the production node, you can follow the [tutorial here](https://blog.ceramic.network/configuring-a-ceramic-node-using-aws/). 
<!-- update link after Server Setup Guode  -->

The Ceramic CLI provides a set of commands that make it easier to run and manage Ceramic nodes. We will start by installing the Ceramic CLI:

<Tabs
  defaultValue="pnpm"
  groupId="npm-or-pnpm-or-yarnr"
  values={[
    {label: 'npm', value: 'npm'},
    {label: 'pnpm', value: 'pnpm'},
    {label: 'yarn', value: 'yarn'},
  ]}>
  <TabItem value="npm">

```bash
npm install --location=global @ceramicnetwork/cli
```

  </TabItem>
  <TabItem value="pnpm">

```bash
pnpm install -g @ceramicnetwork/cli
```

  </TabItem>
  <TabItem value="yarn">

:::caution

Global packages are only supported for yarn 2.x and older. For yarn 3.x and newer, use `yarn dlx` to run composedb cli commands

:::

```bash
yarn global add @ceramicnetwork/cli
```

  </TabItem>
</Tabs>

### ComposeDB

Next install the ComposeDB CLI, which enables you to interact with ComposeDB data from your terminal. Install ComposeDB CLI using the following command:

<Tabs
  defaultValue="pnpm"
  groupId="npm-or-pnpm-or-yarnr"
  values={[
    {label: 'npm', value: 'npm'},
    {label: 'pnpm', value: 'pnpm'},
    {label: 'yarn', value: 'yarn'},
  ]}>
  <TabItem value="npm">

```bash
npm install --location=global @composedb/cli@^0.3.0
```

  </TabItem>
  <TabItem value="pnpm">

```bash
pnpm add -g @composedb/cli@^0.3.0
```

  </TabItem>
  <TabItem value="yarn">

:::caution

Global packages are only supported for yarn 2.x and older. For yarn 3.x and newer, use `yarn dlx` to run composedb cli commands

:::

```bash
yarn global add @composedb/cli@^0.3.0
```

  </TabItem>
</Tabs>

ComposeDB provides two additional libraries that support development: 
1. [@composedb/devtools](./api/modules/devtools.md) containing utilities related to managing composites
2. [@composedb/devtools-node](./api/modules/devtools_node.md) which contains utilities for interacting with the local file system and starting a local HTTP server. 

To install the development packages, run:

<Tabs
  defaultValue="pnpm"
  groupId="package-manager"
  values={[
    {label: 'npm', value: 'npm'},
    {label: 'pnpm', value: 'pnpm'},
    {label: 'yarn', value: 'yarn'},
  ]}>
  <TabItem value="npm">

```bash
npm install -D @composedb/devtools@^0.3.0 @composedb/devtools-node@^0.3.0
```

  </TabItem>
  <TabItem value="pnpm">

```bash
pnpm add -D @composedb/devtools@^0.3.0 @composedb/devtools-node@^0.3.0
```

  </TabItem>
  <TabItem value="yarn">

```bash
yarn add -D @composedb/devtools@^0.3.0 @composedb/devtools-node@^0.3.0
```

  </TabItem>
</Tabs>

## Setup
---
### Run a Ceramic node
You can check that everything was installed correctly by spinning up a Ceramic node. Running the command below will start the Ceramic node in local mode and connect to Clay testnet. 
Indexing is a key component of ComposeDB, which syncs data across nodes. Enable indexing by toggling:

<Tabs
  defaultValue="pnpm"
  groupId="package-manager"
  values={[
    {label: 'npm', value: 'npm'},
    {label: 'pnpm', value: 'pnpm'},
    {label: 'yarn', value: 'yarn'},
  ]}>
  <TabItem value="npm">

```bash
CERAMIC_ENABLE_EXPERIMENTAL_COMPOSE_DB='true' npx @ceramicnetwork/cli daemon
```

  </TabItem>
  <TabItem value="pnpm">

```bash
CERAMIC_ENABLE_EXPERIMENTAL_COMPOSE_DB='true' pnpm dlx @ceramicnetwork/cli daemon
```

  </TabItem>
  <TabItem value="yarn">

```bash
CERAMIC_ENABLE_EXPERIMENTAL_COMPOSE_DB='true' yarn dlx @ceramicnetwork/cli daemon
```

  </TabItem>
</Tabs>


:::note
When you see `IMPORTANT: Ceramic API running on 0.0.0.0:7007` in your terminal, you have successfully started a local node on Clay testnet! ðŸš€
:::

:::note
After you start a node, a configuration file is created at `~/.ceramic/daemon.config.json`. You can edit this file to modify configurations such as network.
:::


## Developer Account
---
### Generate your private key
You will need a private key for authorizing ComposeDB CLI commands in the later stages of development. You can generate it using the command below. Save it for later use:

```bash
composedb did:generate-private-key
```

:::caution

**Important:** Store your private key securely, it allows changes to be made to your app.

:::

### Generate your account
Indexing is one of the key features of ComposeDB. In order to notify the Ceramic node which models have to be indexed, the ComposeDB tools have to interact with the restricted Admin API. Calling the API requires an authenticated Decentralized Identifier (DID) to be provided in the node configuration file. Create a DID by running the following command, using the private key generated previously:

```bash
composedb did:from-private-key your-private-key
```

:::note
Copy the DID output of this command and store it in a secure place, just like with your private key above. This public DID key will have to be provided in your Ceramic nodeâ€™s configuration file to ensure that only you can make changes to your app, such as deploying composites.
:::
  

### Using your account
Provide the authenticated DID by opening the node configuration file which defaults to `~/.ceramic/daemon.config.json` and specifying it in the `admin-dids` section of the file as shown below:

```json
{
  ...
  "http-api": {
    ...
    "admin-dids": ["did:key:..."]
  },
  "indexing": {
    ...
    "allow-queries-before-historical-sync": true
  }
}
```

Save this file. By this point you should have your development environment and all configurations in place to get started working on your application.
  

## Confirmation
---
As a final test, spin up the Ceramic local node:

```bash
ceramic daemon --network=testnet-clay
```

You should see your Ceramic node up and running with this message `IMPORTANT: Ceramic API running on 0.0.0.0:7007`.

## Next Steps
---
After setting up your environment, the next step is to [**Create your composite â†’**](./create-your-composite.mdx)

<!-- ## Related Guides
Ready to upgrade from a local node to production? Learn how to deploy your app: [Server configuration](https://www.notion.so/Server-configuration-226c2bf34a6d43e9b7e8331b823735ed) -->
